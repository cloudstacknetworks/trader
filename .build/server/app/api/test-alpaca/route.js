"use strict";(()=>{var e={};e.id=5782,e.ids=[5782],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},72978:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>q,patchFetch:()=>x,requestAsyncStorage:()=>h,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>y});var s={};r.r(s),r.d(s,{POST:()=>d,dynamic:()=>l});var a=r(79182),n=r(72007),o=r(56719),i=r(93442),c=r(15649),u=r(11826),p=r(84729);let l="force-dynamic";async function d(e){try{let t=await (0,c.getServerSession)(u.L);if(!t?.user?.id)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{apiKey:r,secretKey:s,isPaperTrading:a}=await e.json();if(!r||!s)return i.NextResponse.json({error:"API key and secret key are required"},{status:400});let n=(0,p.p)({apiKey:r,secretKey:s,isPaperTrading:!1!==a}),o=await n.getAccount();return i.NextResponse.json({success:!0,accountInfo:{accountNumber:o.account_number,status:o.status,tradingBlocked:o.trading_blocked,equity:o.equity,buyingPower:o.buying_power}})}catch(e){return console.error("Alpaca connection test error:",e),i.NextResponse.json({error:"Failed to connect to Alpaca API"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/test-alpaca/route",pathname:"/api/test-alpaca",filename:"route",bundlePath:"app/api/test-alpaca/route"},resolvedPagePath:"/home/ubuntu/oshaughnessy_trader/nextjs_space/app/api/test-alpaca/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:y,serverHooks:g}=m,q="/api/test-alpaca/route";function x(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:y})}},84729:(e,t,r)=>{r.d(t,{p:()=>a});class s{constructor(e){this.config=e,this.baseUrl=e.isPaperTrading?"https://paper-api.alpaca.markets":"https://api.alpaca.markets"}async makeRequest(e,t={}){let r={"APCA-API-KEY-ID":this.config.apiKey,"APCA-API-SECRET-KEY":this.config.secretKey,"Content-Type":"application/json",...t.headers};try{let s=await fetch(`${this.baseUrl}${e}`,{...t,headers:r});if(!s.ok){let e=await s.text();throw Error(`Alpaca API error: ${s.status} - ${e}`)}return await s.json()}catch(t){throw console.error(`Alpaca API request failed for ${e}:`,t),t}}async getAccount(){return this.makeRequest("/v2/account")}async getPositions(){return this.makeRequest("/v2/positions")}async getPosition(e){return this.makeRequest(`/v2/positions/${e}`)}async getOrders(e){let t=e?`?status=${e}`:"";return this.makeRequest(`/v2/orders${t}`)}async getOrder(e){return this.makeRequest(`/v2/orders/${e}`)}async createOrder(e){return this.makeRequest("/v2/orders",{method:"POST",body:JSON.stringify(e)})}async cancelOrder(e){return this.makeRequest(`/v2/orders/${e}`,{method:"DELETE"})}async cancelAllOrders(){return this.makeRequest("/v2/orders",{method:"DELETE"})}async getPortfolioHistory(e,t){let r=new URLSearchParams;return e&&r.append("period",e),t&&r.append("timeframe",t),this.makeRequest(`/v2/account/portfolio/history?${r.toString()}`)}async getBars(e,t,r,s){let a=new URLSearchParams({symbols:e.join(","),timeframe:t});return r&&a.append("start",r),s&&a.append("end",s),this.makeRequest(`/v2/stocks/bars?${a.toString()}`)}async getLatestTrades(e){let t=new URLSearchParams({symbols:e.join(",")});return this.makeRequest(`/v2/stocks/trades/latest?${t.toString()}`)}async getLatestQuotes(e){let t=new URLSearchParams({symbols:e.join(",")});return this.makeRequest(`/v2/stocks/quotes/latest?${t.toString()}`)}}function a(e){return new s(e)}},11826:(e,t,r)=>{r.d(t,{L:()=>u});var s=r(64617),a=r(66291),n=r(88120),o=r(3390),i=r.n(o),c=r(83178);let u={adapter:(0,s.N)(c._),providers:[(0,n.Z)({clientId:process.env.GOOGLE_CLIENT_ID||"",clientSecret:process.env.GOOGLE_CLIENT_SECRET||"",authorization:{params:{prompt:"consent",access_type:"offline",response_type:"code"}}}),(0,a.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await c._.user.findUnique({where:{email:e.email}});return t?.password&&await i().compare(e.password,t.password)?{id:t.id,email:t.email,name:t.name}:null}})],session:{strategy:"jwt"},pages:{signIn:"/auth/signin"},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id),e),session:async({session:e,token:t})=>(t&&e.user&&(e.user.id=t.id),e)}}},83178:(e,t,r)=>{r.d(t,{_:()=>a});var s=r(53524);let a=globalThis.prisma??new s.PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4372,7329,4178,7609],()=>r(72978));module.exports=s})();