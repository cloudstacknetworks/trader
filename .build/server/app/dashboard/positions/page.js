(()=>{var e={};e.id=8309,e.ids=[8309],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},86624:e=>{"use strict";e.exports=require("querystring")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},32458:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>u,tree:()=>c}),t(23037),t(38723),t(71363);var r=t(36576),a=t(72007),i=t(21818),n=t.n(i),l=t(88897),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let c=["",{children:["dashboard",{children:["positions",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,23037)),"/home/ubuntu/oshaughnessy_trader/nextjs_space/app/dashboard/positions/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,38723)),"/home/ubuntu/oshaughnessy_trader/nextjs_space/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,71363,23)),"next/dist/client/components/not-found-error"]}],o=["/home/ubuntu/oshaughnessy_trader/nextjs_space/app/dashboard/positions/page.tsx"],x="/dashboard/positions/page",m={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/positions/page",pathname:"/dashboard/positions",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},57555:(e,s,t)=>{Promise.resolve().then(t.bind(t,64548)),Promise.resolve().then(t.bind(t,23486))},23486:(e,s,t)=>{"use strict";t.d(s,{PositionsView:()=>g});var r=t(62901),a=t(24383),i=t(23803),n=t(31606),l=t(27878),d=t(80568),c=t(10780),o=t(33901),x=t(79357),m=t(30808),u=t(45302),h=t(21680),p=t(21391),j=t(42594);function g(){let[e,s]=(0,a.useState)([]),[t,g]=(0,a.useState)(!0),[y,f]=(0,a.useState)(!1),[N,v]=(0,a.useState)(null),b=async()=>{try{let e=await fetch("/api/positions"),t=await e.json();s(t||[])}catch(e){console.error("Error fetching positions:",e)}finally{g(!1),f(!1)}},w=async e=>{if(confirm("Are you sure you want to close this position?")){v(e);try{(await fetch(`/api/positions/${e}/close`,{method:"POST"})).ok?await b():alert("Failed to close position. Please try again.")}catch(e){console.error("Error closing position:",e),alert("Error closing position. Please try again.")}finally{v(null)}}};if(t)return r.jsx("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 mb-4"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-96 mb-6"}),r.jsx("div",{className:"grid gap-4",children:[1,2,3].map(e=>r.jsx("div",{className:"h-32 bg-gray-200 rounded"},e))})]})});let P=e.reduce((e,s)=>e+Number(s.unrealizedPnl||0),0),Z=e.reduce((e,s)=>e+Number(s.currentPrice||s.entryPrice)*s.quantity,0),k=e.filter(e=>Number(e.unrealizedPnl||0)>0).length;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Open Positions"}),r.jsx("p",{className:"text-gray-600",children:"Monitor your active trades and unrealized P&L"})]}),(0,r.jsxs)(l.z,{onClick:()=>{f(!0),b()},disabled:y,variant:"outline",className:"flex items-center space-x-2",children:[r.jsx(c.Z,{className:`h-4 w-4 ${y?"animate-spin":""}`}),r.jsx("span",{children:"Refresh Prices"})]})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(i.ll,{className:"text-sm font-medium",children:"Open Positions"}),r.jsx(o.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(i.aY,{children:[r.jsx("div",{className:"text-2xl font-bold",children:e.length}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Active trades"})]})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(i.ll,{className:"text-sm font-medium",children:"Total Value"}),r.jsx(x.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(i.aY,{children:[(0,r.jsxs)("div",{className:"text-2xl font-bold",children:["$",Z.toFixed(2)]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Market value"})]})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(i.ll,{className:"text-sm font-medium",children:"Unrealized P&L"}),P>=0?r.jsx(m.Z,{className:"h-4 w-4 text-green-600"}):r.jsx(u.Z,{className:"h-4 w-4 text-red-600"})]}),(0,r.jsxs)(i.aY,{children:[(0,r.jsxs)("div",{className:`text-2xl font-bold ${P>=0?"text-green-600":"text-red-600"}`,children:[P>=0?"+":"","$",P.toFixed(2)]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Total unrealized"})]})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(i.ll,{className:"text-sm font-medium",children:"Win Rate"}),r.jsx(m.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(i.aY,{children:[(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[e.length>0?Math.round(k/e.length*100):0,"%"]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently winning"})]})]})]}),e.length>0?r.jsx("div",{className:"space-y-4",children:e.map(e=>{let s=Number(e.unrealizedPnl||0),t=Number(e.currentPrice||e.entryPrice),a=Number(e.entryPrice),d=a>0?(t-a)/a*100:0,c=t*e.quantity,o=Number(e.trailingStopPrice||0),x=new Date(e.entryTime),m=Math.floor((Date.now()-x.getTime())/6e4),u=s>=0;return r.jsx(i.Zb,{className:`${u?"border-green-200":"border-red-200"}`,children:r.jsx(i.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"flex-1",children:r.jsx("div",{className:"flex items-center space-x-4",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:"text-2xl font-bold text-gray-900",children:e.ticker}),r.jsx(n.C,{variant:"outline",className:`${u?"border-green-500 text-green-700":"border-red-500 text-red-700"}`,children:u?"Winning":"Losing"}),o>0&&t<1.02*o&&(0,r.jsxs)(n.C,{variant:"outline",className:"border-orange-500 text-orange-700",children:[r.jsx(h.Z,{className:"h-3 w-3 mr-1"}),"Near Stop"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-3 text-sm",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Quantity"}),(0,r.jsxs)("p",{className:"font-medium",children:[e.quantity," shares"]})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Entry Price"}),(0,r.jsxs)("p",{className:"font-medium",children:["$",a.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Current Price"}),(0,r.jsxs)("p",{className:"font-medium",children:["$",t.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Total Value"}),(0,r.jsxs)("p",{className:"font-medium",children:["$",c.toFixed(2)]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2 text-sm",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Time Held"}),(0,r.jsxs)("p",{className:"font-medium flex items-center",children:[r.jsx(p.Z,{className:"h-3 w-3 mr-1"}),m<60?`${m}m`:`${Math.floor(m/60)}h ${m%60}m`]})]}),o>0&&(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Trailing Stop"}),(0,r.jsxs)("p",{className:"font-medium",children:["$",o.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Entry Time"}),r.jsx("p",{className:"font-medium",children:x.toLocaleDateString()})]})]})]})})}),(0,r.jsxs)("div",{className:"text-right space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:`text-2xl font-bold ${u?"text-green-600":"text-red-600"}`,children:[s>=0?"+":"","$",s.toFixed(2)]}),(0,r.jsxs)("div",{className:`text-lg ${u?"text-green-600":"text-red-600"}`,children:[d>=0?"+":"",d.toFixed(2),"%"]})]}),(0,r.jsxs)(l.z,{onClick:()=>w(e.id),disabled:N===e.id,variant:"outline",size:"sm",className:"flex items-center space-x-1 text-red-600 border-red-300 hover:bg-red-50",children:[r.jsx(j.Z,{className:"h-3 w-3"}),r.jsx("span",{children:N===e.id?"Closing...":"Close"})]})]})]})})},e.id)})}):r.jsx(i.Zb,{children:r.jsx(i.aY,{className:"pt-8",children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[r.jsx(o.Z,{className:"h-12 w-12 text-gray-400 mb-4"}),r.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"No Open Positions"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Positions will appear here when trades are executed"})]})})}),(0,r.jsxs)(d.bZ,{children:[r.jsx(h.Z,{className:"h-4 w-4"}),(0,r.jsxs)(d.X,{children:[r.jsx("strong",{children:"Automated Trading:"})," Positions are monitored every 15 minutes during market hours. Trailing stop-loss orders are managed automatically via Alpaca API."]})]})]})}},80568:(e,s,t)=>{"use strict";t.d(s,{X:()=>c,bZ:()=>d});var r=t(62901),a=t(24383),i=t(47279),n=t(68637);let l=(0,i.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=a.forwardRef(({className:e,variant:s,...t},a)=>r.jsx("div",{ref:a,role:"alert",className:(0,n.cn)(l({variant:s}),e),...t}));d.displayName="Alert",a.forwardRef(({className:e,...s},t)=>r.jsx("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",e),...s})).displayName="AlertTitle";let c=a.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",e),...s}));c.displayName="AlertDescription"},21391:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(71945).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},79357:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(71945).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},10780:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(71945).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},45302:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(71945).Z)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]])},21680:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(71945).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},23037:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var r=t(83537),a=t(15438),i=t(15649),n=t(11826),l=t(96184);let d=(0,t(88895).createProxy)(String.raw`/home/ubuntu/oshaughnessy_trader/nextjs_space/components/positions-view.tsx#PositionsView`);async function c(){return await (0,i.getServerSession)(n.L)||(0,a.redirect)("/auth/signin"),r.jsx(l.c,{children:r.jsx(d,{})})}}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[4372,7329,4178,5446,9551,5253,8045,2631],()=>t(32458));module.exports=r})();