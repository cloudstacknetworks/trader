(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8309],{70470:function(e,s,t){Promise.resolve().then(t.bind(t,40696)),Promise.resolve().then(t.bind(t,33896))},33896:function(e,s,t){"use strict";t.d(s,{PositionsView:function(){return p}});var r=t(15444),a=t(89300),i=t(99827),l=t(61335),n=t(2422),c=t(56948),d=t(81471),x=t(26378),o=t(83648),m=t(64670),u=t(48967),h=t(70362),j=t(62492),f=t(33485);function p(){let[e,s]=(0,a.useState)([]),[t,p]=(0,a.useState)(!0),[g,N]=(0,a.useState)(!1),[y,v]=(0,a.useState)(null),b=async()=>{try{let e=await fetch("/api/positions"),t=await e.json();s(t||[])}catch(e){console.error("Error fetching positions:",e)}finally{p(!1),N(!1)}};(0,a.useEffect)(()=>{b();let e=setInterval(b,3e4);return()=>clearInterval(e)},[]);let w=async e=>{if(confirm("Are you sure you want to close this position?")){v(e);try{(await fetch(`/api/positions/${e}/close`,{method:"POST"})).ok?await b():alert("Failed to close position. Please try again.")}catch(e){console.error("Error closing position:",e),alert("Error closing position. Please try again.")}finally{v(null)}}};if(t)return(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-48 mb-4"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-96 mb-6"}),(0,r.jsx)("div",{className:"grid gap-4",children:[1,2,3].map(e=>(0,r.jsx)("div",{className:"h-32 bg-gray-200 rounded"},e))})]})});let Z=e.reduce((e,s)=>e+Number(s.unrealizedPnl||0),0),k=e.reduce((e,s)=>e+Number(s.currentPrice||s.entryPrice)*s.quantity,0),P=e.filter(e=>Number(e.unrealizedPnl||0)>0).length;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Open Positions"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Monitor your active trades and unrealized P&L"})]}),(0,r.jsxs)(n.z,{onClick:()=>{N(!0),b()},disabled:g,variant:"outline",className:"flex items-center space-x-2",children:[(0,r.jsx)(d.Z,{className:`h-4 w-4 ${g?"animate-spin":""}`}),(0,r.jsx)("span",{children:"Refresh Prices"})]})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(i.ll,{className:"text-sm font-medium",children:"Open Positions"}),(0,r.jsx)(x.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(i.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:e.length}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Active trades"})]})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(i.ll,{className:"text-sm font-medium",children:"Total Value"}),(0,r.jsx)(o.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(i.aY,{children:[(0,r.jsxs)("div",{className:"text-2xl font-bold",children:["$",k.toFixed(2)]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Market value"})]})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(i.ll,{className:"text-sm font-medium",children:"Unrealized P&L"}),Z>=0?(0,r.jsx)(m.Z,{className:"h-4 w-4 text-green-600"}):(0,r.jsx)(u.Z,{className:"h-4 w-4 text-red-600"})]}),(0,r.jsxs)(i.aY,{children:[(0,r.jsxs)("div",{className:`text-2xl font-bold ${Z>=0?"text-green-600":"text-red-600"}`,children:[Z>=0?"+":"","$",Z.toFixed(2)]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total unrealized"})]})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(i.ll,{className:"text-sm font-medium",children:"Win Rate"}),(0,r.jsx)(m.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(i.aY,{children:[(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[e.length>0?Math.round(P/e.length*100):0,"%"]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Currently winning"})]})]})]}),e.length>0?(0,r.jsx)("div",{className:"space-y-4",children:e.map(e=>{let s=Number(e.unrealizedPnl||0),t=Number(e.currentPrice||e.entryPrice),a=Number(e.entryPrice),c=a>0?(t-a)/a*100:0,d=t*e.quantity,x=Number(e.trailingStopPrice||0),o=new Date(e.entryTime),m=Math.floor((Date.now()-o.getTime())/6e4),u=s>=0;return(0,r.jsx)(i.Zb,{className:`${u?"border-green-200":"border-red-200"}`,children:(0,r.jsx)(i.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:e.ticker}),(0,r.jsx)(l.C,{variant:"outline",className:`${u?"border-green-500 text-green-700":"border-red-500 text-red-700"}`,children:u?"Winning":"Losing"}),x>0&&t<1.02*x&&(0,r.jsxs)(l.C,{variant:"outline",className:"border-orange-500 text-orange-700",children:[(0,r.jsx)(h.Z,{className:"h-3 w-3 mr-1"}),"Near Stop"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-3 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Quantity"}),(0,r.jsxs)("p",{className:"font-medium",children:[e.quantity," shares"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Entry Price"}),(0,r.jsxs)("p",{className:"font-medium",children:["$",a.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Current Price"}),(0,r.jsxs)("p",{className:"font-medium",children:["$",t.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Total Value"}),(0,r.jsxs)("p",{className:"font-medium",children:["$",d.toFixed(2)]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Time Held"}),(0,r.jsxs)("p",{className:"font-medium flex items-center",children:[(0,r.jsx)(j.Z,{className:"h-3 w-3 mr-1"}),m<60?`${m}m`:`${Math.floor(m/60)}h ${m%60}m`]})]}),x>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Trailing Stop"}),(0,r.jsxs)("p",{className:"font-medium",children:["$",x.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Entry Time"}),(0,r.jsx)("p",{className:"font-medium",children:o.toLocaleDateString()})]})]})]})})}),(0,r.jsxs)("div",{className:"text-right space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:`text-2xl font-bold ${u?"text-green-600":"text-red-600"}`,children:[s>=0?"+":"","$",s.toFixed(2)]}),(0,r.jsxs)("div",{className:`text-lg ${u?"text-green-600":"text-red-600"}`,children:[c>=0?"+":"",c.toFixed(2),"%"]})]}),(0,r.jsxs)(n.z,{onClick:()=>w(e.id),disabled:y===e.id,variant:"outline",size:"sm",className:"flex items-center space-x-1 text-red-600 border-red-300 hover:bg-red-50",children:[(0,r.jsx)(f.Z,{className:"h-3 w-3"}),(0,r.jsx)("span",{children:y===e.id?"Closing...":"Close"})]})]})]})})},e.id)})}):(0,r.jsx)(i.Zb,{children:(0,r.jsx)(i.aY,{className:"pt-8",children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,r.jsx)(x.Z,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,r.jsx)("p",{className:"text-lg text-gray-600 mb-2",children:"No Open Positions"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Positions will appear here when trades are executed"})]})})}),(0,r.jsxs)(c.bZ,{children:[(0,r.jsx)(h.Z,{className:"h-4 w-4"}),(0,r.jsxs)(c.X,{children:[(0,r.jsx)("strong",{children:"Automated Trading:"})," Positions are monitored every 15 minutes during market hours. Trailing stop-loss orders are managed automatically via Alpaca API."]})]})]})}},56948:function(e,s,t){"use strict";t.d(s,{X:function(){return d},bZ:function(){return c}});var r=t(15444),a=t(89300),i=t(2371),l=t(65522);let n=(0,i.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=a.forwardRef(({className:e,variant:s,...t},a)=>(0,r.jsx)("div",{ref:a,role:"alert",className:(0,l.cn)(n({variant:s}),e),...t}));c.displayName="Alert",a.forwardRef(({className:e,...s},t)=>(0,r.jsx)("h5",{ref:t,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",e),...s})).displayName="AlertTitle";let d=a.forwardRef(({className:e,...s},t)=>(0,r.jsx)("div",{ref:t,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",e),...s}));d.displayName="AlertDescription"},62492:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(42154).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},83648:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(42154).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},81471:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(42154).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},48967:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(42154).Z)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]])},70362:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(42154).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])}},function(e){e.O(0,[2616,572,5007,5762,1401,8371,4405,2386,7156,1744],function(){return e(e.s=70470)}),_N_E=e.O()}]);